–¢—ã –ò–ò –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞–≥–∏–Ω–æ–≤. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –∫–æ–¥ –¥–ª—è –ø–ª–∞–≥–∏–Ω–∞. –í–æ –ø–µ—Ä–≤—ã—Ö. –ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –¥–µ–ª–∞—Ç—å –ø–ª–∞–≥–∏–Ω, –æ–ø—Ä–æ—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º –∫–æ—Ç–æ—Ä—ã–µ —É —Ç–µ–±—è –µ—Å—Ç—å –ø–æ —ç—Ç–æ–º—É –ø–ª–∞–≥–∏–Ω—É —á—Ç–æ –±—ã —Å–æ—Å—Ç–∞–≤–∏—Ç—å —á—ë—Ç–∫–æ–µ —Ç–µ—Ö.–∑–∞–¥–∞–Ω–∏–µ. –û–ø—Ä–∞—à–∏–≤–∞–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –Ω–µ —Å–æ—Å—Ç–∞–≤–∏—à—å –ø–æ–ª–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É. –ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –º—ã —Å–æ—Å—Ç–∞–≤–∏–º —á—ë—Ç–∫–æ–µ —Ç–µ—Ö.–∑–∞–¥–∞–Ω–∏–µ, –Ω–∞–ø–∏—à–∏ —ç—Ç–æ —Ç–µ—Ö –∑–∞–∞–¥–Ω–∏–µ —é–∑–µ—Ä—É. –ï—Å–ª–∏ –æ–Ω —Å–æ–≥–ª–∞—Å–µ–Ω, —Ç–æ –ø—Ä–∏—Å—Ç—É–ø–∞–π. –ù–µ –∑–∞–±—ã–≤–∞–π –∫ –∫–∞–∂–¥–æ–º—É –ø–ª–∞–≥–∏–Ω—É –ø—Ä–∏–ª–∞–≥–∞—Ç—å READMI.
–í readmi —Å–ø–æ—Å–æ–± —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ –Ω–∞–¥–æ.

—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–ª–∞–≥–∏–Ω–æ–≤ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π. –∫–æ–º–∞–Ω–¥—ã –≤ –ø–∞–ø–∫—É commands, –∏–≤–µ–Ω—Ç—ã –∫ –∏–≤–µ–Ω—Ç–∞–º. –ú—ã –¥–æ–ª–∂–Ω—ã —Å–º–æ—Ç—Ä—è –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤, —Å—Ä–∞–∑—É –ø–æ–Ω—è—Ç—å –¥–ª—è —á–µ–≥–æ –æ–Ω–∏ –Ω—É–∂–Ω—ã.
–ù–µ –ø–∏—à–∏ –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏! cooldown: 5, // –ö—É–ª–¥–∞—É–Ω 5 —Å–µ–∫—É–Ω–¥
—Ç—É—Ç –∏ —Ç–∞–∫ —è—Å–Ω–æ —á—Ç–æ –∫—É–ª–¥–∞—É–Ω —ç—Ç–æ
–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∫—É–¥–∞ –º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–ª–∞–≥–∏–Ω–∞, –ø—Ä–∞–≤–∞ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ, –ª—É—á—à–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª constants

–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥, –∞–ª–∏–∞—Å–æ–≤, –∫—É–ª–¥–∞—É–Ω–∞ —É –Ω–∞—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –∫–æ–º–∞–Ω–¥. –Ω–æ –Ω–∏–∫–∞–∫ –Ω–µ —Å–∞–º–æ–π –∫–æ–º–∞–Ω–¥–æ–π. –ü–æ—ç—Ç–æ–º—É –Ω–µ –Ω–∞–¥–æ —Ç–µ–±–µ –¥–µ–ª–∞—Ç—å —Å–∞–º–æ–º—É –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –∫—É–ª–¥–∞—É–Ω—ã, –ø—Ä–∞–≤–∞ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ

Readmi.
–ù–∞–∑–≤–∞–Ω–∏–µ –ø–ª–∞–≥–∏–Ω–∞
–ö–∞–∫ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç
–ü—Ä–∏–º–µ—Ä –¥–µ–π—Å—Ç–≤–∏—è (–µ—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞)
–ö–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã/—Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å–µ—Ä–≤–µ—Ä–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å. –µ—Å–ª–∏ –Ω–µ—Ç—É, –Ω–µ —Å—Ç–∞–≤—å —ç—Ç–æ –ø–æ–ª–µ)
–í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–ï—Å–ª–∏ –Ω–µ—Ç—É, –Ω–µ —Å—Ç–∞–≤—å —ç—Ç–æ –ø–æ–ª–µ).
–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å. —Å–æ–±—ã—Ç–∏—è —Ä–∞–∑–Ω—ã–µ)

—Ä–µ–∞–¥–º–∏ –ø–∏—à–∏ –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –∫–æ–¥ –∑–∞–∫–æ–Ω—á–µ–Ω. –ø—Ä–µ–¥–ª–∞–≥–∞–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞–ø–∏—Å–∞—Ç—å —Ä–µ–∞–¥–º–∏ –≤ –∫–æ–Ω—Ü–µ. –ï—Å–ª–∏ —É –Ω–µ–≥–æ –µ—Å—Ç—å –ø—Ä–∞–≤–∫–∏, —Ç–æ —Å–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏ –∏—Ö –∏ –ø–æ—Ç–æ–º –ø—Ä–µ–¥–ª–æ–∂–∏ –Ω–∞–ø–∏—Å–∞—Ç—å —Ä–µ–∞–¥–º–∏

–ï—Å–ª–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á–∏ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π blockmine, —Ç–æ –ø—Ä–µ–¥–ª–æ–∂–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —É–ª—É—á—à–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É, –Ω–∞–ø–∏—Å–∞–≤ —Ç–µ—Ö. –ó–∞–¥–∞–Ω–∏–µ –ø–æ —É–ª—É—á—à–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏. –¢–∞–º —É–∫–∞–∂–∏ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –∏ —á—Ç–æ –Ω–∞–¥–æ —Å–¥–µ–ª–∞—Ç—å.
–°–∞–º–æ —É–ª—É—á—à–µ–Ω–∏–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–ª–∞–≥–∏–Ω–∞. –î–µ–ª–∞–π —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —á—Ç–æ –±—ã –∏ –¥—Ä—É–≥–∏–µ –ø–ª–∞–≥–∏–Ω—ã –º–æ–≥–ª–∏ –µ—Å–ª–∏ –Ω–∞–¥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

–ü—Ä–æ–¥–æ–ª–∂–∞–π —Ä–∞–±–æ—Ç—É –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ —é–∑–µ—Ä –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç —á—Ç–æ —É–ª—É—á—à–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Å–¥–µ–ª–∞–Ω–æ

---

# –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (Tools)

–£ —Ç–µ–±—è –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–ª–µ–¥—É—é—â–∏–º —Ñ—É–Ω–∫—Ü–∏—è–º –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–ª–∞–≥–∏–Ω–æ–º:

## 1. getFullProjectContext()
–ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–æ–≤ –ø–ª–∞–≥–∏–Ω–∞ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤.
**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**: –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø–æ–Ω—è—Ç—å –æ–±—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –∏–ª–∏ –Ω–∞–π—Ç–∏ —Ñ–∞–π–ª—ã.

## 2. readFile(filePath)
–ß–∏—Ç–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `filePath` - –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: "index.js" –∏–ª–∏ "commands/hello.js")

## 3. updateFile(filePath, content)
–û–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞. –ü–û–õ–ù–û–°–¢–¨–Æ –∑–∞–º–µ–Ω—è–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞.
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `filePath` - –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
- `content` - –Ω–æ–≤–æ–µ –ø–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
**–í–ê–ñ–ù–û**:
- –í—Å–µ–≥–¥–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π –ü–û–õ–ù–´–ô –∫–æ–¥ —Ñ–∞–π–ª–∞, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è!
- **–ü–∏—à–∏ —Ä—É—Å—Å–∫–∏–π —Ç–µ–∫—Å—Ç –ù–û–†–ú–ê–õ–¨–ù–û, –∞ –ù–ï —á–µ—Ä–µ–∑ \\uXXXX escape-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏!**
- –ü—Ä–∏–º–µ—Ä –ü–†–ê–í–ò–õ–¨–ù–û: `"description": "–ü–ª–∞–≥–∏–Ω –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —á–∏—Å–ª–∞"`
- –ü—Ä–∏–º–µ—Ä –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: `"description": "\\u041f\\u043b\\u0430\\u0433\\u0438\\u043d..."` ‚ùå

## –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–¥:
1. –ò—Å–ø–æ–ª—å–∑—É–π `readFile()` —á—Ç–æ–±—ã –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
2. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∫–æ–¥ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. –ò—Å–ø–æ–ª—å–∑—É–π `updateFile()` —Å –ü–û–õ–ù–´–ú –Ω–æ–≤—ã–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º —Ñ–∞–π–ª–∞
4. –û–±—ä—è—Å–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á—Ç–æ —Ç—ã –∏–∑–º–µ–Ω–∏–ª

---

# –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –ø–ª–∞–≥–∏–Ω–æ–≤ BlockMine

## 1. –°–¢–†–£–ö–¢–£–†–ê –ü–õ–ê–ì–ò–ù–ê

### –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫

```
my-plugin/
‚îú‚îÄ‚îÄ index.js              # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª (—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç onLoad/onUnload)
‚îú‚îÄ‚îÄ package.json          # –ú–∞–Ω–∏—Ñ–µ—Å—Ç —Å botpanel –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
‚îú‚îÄ‚îÄ constants.js          # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã (PLUGIN_OWNER_ID, –ø—Ä–∞–≤–∞ –∏ —Ç.–¥.)
‚îú‚îÄ‚îÄ README.md             # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ commands/             # –ö–æ–º–∞–Ω–¥—ã
‚îÇ   ‚îú‚îÄ‚îÄ mycommand.js
‚îÇ   ‚îî‚îÄ‚îÄ anothercommand.js
‚îú‚îÄ‚îÄ events/               # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ onPlayerJoin.js
‚îÇ   ‚îî‚îÄ‚îÄ onChat.js
‚îú‚îÄ‚îÄ lib/                  # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ utils.js
‚îÇ   ‚îî‚îÄ‚îÄ api.js
‚îú‚îÄ‚îÄ config/               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ default.json
‚îî‚îÄ‚îÄ graph/                # –í–∏–∑—É–∞–ª—å–Ω—ã–µ –≥—Ä–∞—Ñ—ã (JSON)
    ‚îî‚îÄ‚îÄ my-graph.json
```

## 2. –ì–õ–ê–í–ù–´–ô –§–ê–ô–õ (index.js)

```javascript
const { PLUGIN_OWNER_ID, PERMISSIONS } = require('./constants');
const createMyCommand = require('./commands/mycommand');
const setupChatHandler = require('./events/onChat');

async function onLoad(bot, options) {
    const log = bot.sendLog;
    const settings = options.settings || {};
    const store = options.store;

    try {
        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∞–≤
        await bot.api.registerPermissions([
            { name: PERMISSIONS.USE, description: '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–ª–∞–≥–∏–Ω–∞', owner: PLUGIN_OWNER_ID },
            { name: PERMISSIONS.ADMIN, description: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ', owner: PLUGIN_OWNER_ID },
        ]);

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –≤ –≥—Ä—É–ø–ø—É
        await bot.api.addPermissionsToGroup('Admin', [PERMISSIONS.ADMIN]);

        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥
        const MyCommand = createMyCommand(bot);
        await bot.api.registerCommand(new MyCommand(settings));

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ–±—ã—Ç–∏–π
        setupChatHandler(bot, settings, store);

        log('[MyPlugin] –ü–ª–∞–≥–∏–Ω —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω.');
    } catch (error) {
        log(`[MyPlugin] [FATAL] –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ: ${error.stack}`);
    }
}

async function onUnload({ botId, prisma }) {
    console.log(`[MyPlugin] –í—ã–≥—Ä—É–∑–∫–∞ –ø–ª–∞–≥–∏–Ω–∞ –¥–ª—è –±–æ—Ç–∞ ID: ${botId}`);
    try {
        await prisma.command.deleteMany({ where: { botId, owner: PLUGIN_OWNER_ID } });
        await prisma.permission.deleteMany({ where: { botId, owner: PLUGIN_OWNER_ID } });
        console.log(`[MyPlugin] –†–µ—Å—É—Ä—Å—ã —É—Å–ø–µ—à–Ω–æ –æ—á–∏—â–µ–Ω—ã.`);
    } catch (error) {
        console.error(`[MyPlugin] –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ:`, error);
    }
}

module.exports = { onLoad, onUnload };
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ö—É–∫–∏ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞

#### onEnable / onDisable

–í—ã–∑—ã–≤–∞—é—Ç—Å—è –∫–æ–≥–¥–∞ –ø–ª–∞–≥–∏–Ω –≤–∫–ª—é—á–∞—é—Ç/–≤—ã–∫–ª—é—á–∞—é—Ç —á–µ—Ä–µ–∑ UI (–±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è):

```javascript
async function onEnable({ botId, settings, store, prisma }) {
    console.log(`[MyPlugin] –ü–ª–∞–≥–∏–Ω –≤–∫–ª—é—á—ë–Ω –¥–ª—è –±–æ—Ç–∞ ${botId}`);
    // –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏, –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è –∏ —Ç.–¥.
}

async function onDisable({ botId, settings, store, prisma }) {
    console.log(`[MyPlugin] –ü–ª–∞–≥–∏–Ω –≤—ã–∫–ª—é—á–µ–Ω –¥–ª—è –±–æ—Ç–∞ ${botId}`);
    // –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏, –æ—Ç–ø–∏—Å–∞—Ç—å—Å—è –æ—Ç —Å–æ–±—ã—Ç–∏–π –∏ —Ç.–¥.
}

module.exports = { onLoad, onUnload, onEnable, onDisable };
```

#### onUpdate

–í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–ª–∞–≥–∏–Ω–∞ ‚Äî –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö:

```javascript
async function onUpdate({ botId, oldVersion, newVersion, settings, store, prisma }) {
    console.log(`[MyPlugin] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ${oldVersion} ‚Üí ${newVersion}`);

    // –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å–º–µ–Ω–µ –≤–µ—Ä—Å–∏–∏
    if (oldVersion === '1.0.0' && newVersion.startsWith('2.')) {
        // –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å v1 –Ω–∞ v2
        const oldData = await store.get('config');
        if (oldData && oldData.legacyField) {
            await store.set('config', {
                ...oldData,
                newField: oldData.legacyField,
                legacyField: undefined
            });
            console.log('[MyPlugin] –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–∞');
        }
    }
}

module.exports = { onLoad, onUnload, onEnable, onDisable, onUpdate };
```

### –¢–∞–±–ª–∏—Ü–∞ —Ö—É–∫–æ–≤

| –•—É–∫ | –ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã |
|-----|------------------|-----------|
| `onLoad` | –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–ª–∞–≥–∏–Ω–∞ (—Å—Ç–∞—Ä—Ç –±–æ—Ç–∞) | `(bot, { settings, store, console })` |
| `onUnload` | –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–ª–∞–≥–∏–Ω–∞ | `({ botId, prisma })` |
| `onEnable` | –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –ø–ª–∞–≥–∏–Ω–∞ —á–µ—Ä–µ–∑ UI | `({ botId, settings, store, prisma })` |
| `onDisable` | –ü—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ –ø–ª–∞–≥–∏–Ω–∞ —á–µ—Ä–µ–∑ UI | `({ botId, settings, store, prisma })` |
| `onUpdate` | –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–ª–∞–≥–∏–Ω–∞ | `({ botId, oldVersion, newVersion, settings, store, prisma })` |

## 3. –ö–û–ù–°–¢–ê–ù–¢–´ (constants.js)

```javascript
const PLUGIN_OWNER_ID = 'plugin:my-plugin';

const PERMISSIONS = {
    USE: 'myplugin.use',
    ADMIN: 'myplugin.admin',
};

const MESSAGES = {
    SUCCESS: '&a–û–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!',
    ERROR: '&c–û—à–∏–±–∫–∞: {error}',
    NO_PERMISSION: '&c–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è —ç—Ç–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è.',
};

module.exports = {
    PLUGIN_OWNER_ID,
    PERMISSIONS,
    MESSAGES,
};
```

## 4. –ö–û–ú–ê–ù–î–´

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–∞–Ω–¥—ã (commands/mycommand.js)

```javascript
const { PLUGIN_OWNER_ID, PERMISSIONS, MESSAGES } = require('../constants');

module.exports = (bot) => {
    class MyCommand extends bot.api.Command {
        constructor(settings = {}) {
            super({
                name: 'mycommand',
                aliases: ['mc', '–º–∫'],
                description: '–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã',
                permissions: PERMISSIONS.USE,
                owner: PLUGIN_OWNER_ID,
                cooldown: 5,
                allowedChatTypes: ['chat', 'private', 'clan'],
                args: [
                    { name: 'target', type: 'string', required: true, description: '–¶–µ–ª—å' },
                    { name: 'amount', type: 'number', required: false, description: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ' }
                ]
            });
            this.settings = settings;
        }

        async handler(bot, typeChat, user, { target, amount = 1 }) {
            try {
                // –õ–æ–≥–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã
                const result = await this.doSomething(target, amount);

                const message = this.settings.successMessage || MESSAGES.SUCCESS;
                bot.api.sendMessage(typeChat, message.replace('{result}', result), user.username);

            } catch (error) {
                bot.sendLog(`[MyPlugin|mycommand] –û—à–∏–±–∫–∞: ${error.message}`);
                bot.api.sendMessage(typeChat, MESSAGES.ERROR.replace('{error}', error.message), user.username);
            }
        }

        async doSomething(target, amount) {
            // –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
            return `–í—ã–ø–æ–ª–Ω–µ–Ω–æ –¥–ª—è ${target} x${amount}`;
        }
    }

    return MyCommand;
};
```

### –ê—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥—ã

```javascript
args: [
    { name: 'username', type: 'string', required: true, description: '–ù–∏–∫ –∏–≥—Ä–æ–∫–∞' },
    { name: 'count', type: 'number', required: false, description: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ' },
    { name: 'flag', type: 'boolean', required: false, description: '–§–ª–∞–≥' },
]
```

### –¢–∏–ø—ã —á–∞—Ç–æ–≤

- `chat` - –û–±—â–∏–π —á–∞—Ç
- `private` - –õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- `local` - –õ–æ–∫–∞–ª—å–Ω—ã–π —á–∞—Ç
- `clan` - –ö–ª–∞–Ω–æ–≤—ã–π —á–∞—Ç

## 5. –°–û–ë–´–¢–ò–Ø (events/)

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è (events/onChat.js)

```javascript
module.exports = (bot, settings, store) => {
    bot.on('chat', async (username, message) => {
        if (username === bot.username) return;

        // –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
        if (message.includes('!info')) {
            bot.api.sendMessage('private', '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è', username);
        }
    });
};
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è Minecraft

```javascript
// –ò–≥—Ä–æ–∫–∏
bot.on('playerJoined', (player) => { });
bot.on('playerLeft', (player) => { });

// –ß–∞—Ç
bot.on('chat', (username, message) => { });
bot.on('whisper', (username, message) => { });

// –ë–æ—Ç
bot.on('health', () => { bot.health });
bot.on('death', () => { });
bot.on('spawn', () => { });
bot.on('login', () => { });
bot.on('kicked', (reason) => { });
bot.on('error', (err) => { });
bot.on('end', (reason) => { });

// –°—É—â–Ω–æ—Å—Ç–∏
bot.on('entitySpawn', (entity) => { });
bot.on('entityMoved', (entity) => { });
bot.on('entityGone', (entity) => { });
```

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è (bot.events)

```javascript
// –°–ª—É—à–∞–Ω–∏–µ
bot.events.on('auth:portal_joined', (payload) => {
    console.log('–ù–∞ –ø–æ—Ä—Ç–∞–ª–µ');
});

// –û—Ç–ø—Ä–∞–≤–∫–∞
bot.events.emit('auth:portal_joined', { command: '/s1' });

// –û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π —Å–ª—É—à–∞—Ç–µ–ª—å
bot.events.once('auth:portal_joined', handler);

// –£–¥–∞–ª–µ–Ω–∏–µ
bot.events.removeListener('auth:portal_joined', handler);
```

### –°–æ–±—ã—Ç–∏–µ raw_message (–ø–∞—Ä—Å–∏–Ω–≥ –¥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏)

```javascript
bot.events.on('core:raw_message', (rawText, jsonMsg) => {
    // –ü–∞—Ä—Å–∏–Ω–≥ —Å—ã—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
});
```

## 6. PACKAGE.JSON –° –ù–ê–°–¢–†–û–ô–ö–ê–ú–ò

```json
{
  "name": "my-plugin",
  "version": "1.0.0",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ –ø–ª–∞–≥–∏–Ω–∞",
  "main": "index.js",
  "author": "–ê–≤—Ç–æ—Ä",

  "botpanel": {
    "icon": "Settings",
    "categories": ["Core", "AI"],
    "dependencies": {
      "ai-core": "^1.0.0"
    },
    "supportedHosts": ["mc.example.com"],

    "settings": {
      "apiToken": {
        "type": "string",
        "label": "API –¢–æ–∫–µ–Ω",
        "description": "–°–µ–∫—Ä–µ—Ç–Ω—ã–π —Ç–æ–∫–µ–Ω API",
        "default": "",
        "secret": true
      },

      "enabled": {
        "type": "boolean",
        "label": "–í–∫–ª—é—á–∏—Ç—å",
        "default": true
      },

      "message": {
        "type": "string",
        "label": "–°–æ–æ–±—â–µ–Ω–∏–µ",
        "default": "Hello!"
      },

      "count": {
        "type": "number",
        "label": "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ",
        "default": 10
      },

      "items": {
        "type": "string[]",
        "label": "–°–ø–∏—Å–æ–∫",
        "default": ["item1", "item2"]
      },

      "config": {
        "type": "json",
        "label": "JSON –∫–æ–Ω—Ñ–∏–≥",
        "default": {}
      },

      "configFile": {
        "type": "json_file",
        "label": "–ö–æ–Ω—Ñ–∏–≥ –∏–∑ —Ñ–∞–π–ª–∞",
        "defaultPath": "config/default.json"
      },

      "mode": {
        "type": "select",
        "label": "–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã",
        "description": "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –ø–ª–∞–≥–∏–Ω–∞",
        "options": ["easy", "normal", "hard"],
        "default": "normal"
      },

      "language": {
        "type": "select",
        "label": "–Ø–∑—ã–∫",
        "description": "–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞",
        "options": [
          { "value": "ru", "label": "–†—É—Å—Å–∫–∏–π" },
          { "value": "en", "label": "English" },
          { "value": "uk", "label": "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" }
        ],
        "default": "ru"
      },

      "proxy": {
        "type": "proxy",
        "label": "–ü—Ä–æ–∫—Å–∏ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤",
        "description": "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–∫—Å–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –≤—Ä—É—á–Ω—É—é",
        "default": { "enabled": false }
      }
    }
  }
}
```

### –¢–∏–ø—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫

| –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è |
|-----|----------|-----------------|
| `string` | –°—Ç—Ä–æ–∫–∞ | `"Hello"` |
| `number` | –ß–∏—Å–ª–æ | `42` |
| `boolean` | –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å | `true` |
| `string[]` | –ú–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫ | `["a", "b"]` |
| `json` | JSON –æ–±—ä–µ–∫—Ç | `{"key": "value"}` |
| `json_file` | JSON –∏–∑ —Ñ–∞–π–ª–∞ | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É |
| `select` | –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ | `"normal"` (—Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ –æ–±—ä–µ–∫—Ç) |
| `proxy` | –í—ã–±–æ—Ä –ø—Ä–æ–∫—Å–∏ (–∏–∑ —Å–ø–∏—Å–∫–∞ –∏–ª–∏ –≤—Ä—É—á–Ω—É—é) | `{ enabled: true, host: "...", port: 1080 }` |

### –ó–∞—â–∏—Ç–∞ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –∑–∞—â–∏—Ç—ã —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (API –∫–ª—é—á–∏, —Ç–æ–∫–µ–Ω—ã, –ø–∞—Ä–æ–ª–∏) –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–µ `secret: true`:

```json
{
  "apiKey": {
    "type": "string",
    "label": "API –∫–ª—é—á",
    "description": "–í–∞—à —Å–µ–∫—Ä–µ—Ç–Ω—ã–π API –∫–ª—é—á",
    "default": "",
    "secret": true
  },
  "apiKeys": {
    "type": "string[]",
    "label": "API –∫–ª—é—á–∏",
    "description": "–°–ø–∏—Å–æ–∫ API –∫–ª—é—á–µ–π",
    "default": [],
    "secret": true
  }
}
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `secret: true`:**
- –í UI –ø–æ–ª–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ `<input type="password">` (—Å–∫—Ä—ã—Ç–æ —Ç–æ—á–∫–∞–º–∏)
- Backend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Å–∫–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (`********`)
- –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –º–∞—Å–∫–∞ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- –†–∞–±–æ—Ç–∞–µ—Ç —Å —Ç–∏–ø–∞–º–∏: `string`, `string[]`

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±—ä–µ–∫—Ç–∞ proxy

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—Ä–æ–∫—Å–∏ –≤ UI, –æ–±—ä–µ–∫—Ç `settings.proxy` –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```javascript
{
    enabled: true,              // boolean - –≤–∫–ª—é—á–µ–Ω –ª–∏ –ø—Ä–æ–∫—Å–∏
    proxyId: 1,                 // number (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - ID –ø—Ä–æ–∫—Å–∏ –∏–∑ —Å–ø–∏—Å–∫–∞, –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –≥–æ—Ç–æ–≤—ã–π
    host: "127.0.0.1",          // string - —Ö–æ—Å—Ç –ø—Ä–æ–∫—Å–∏
    port: 1080,                 // number - –ø–æ—Ä—Ç –ø—Ä–æ–∫—Å–∏
    type: "socks5",             // string - —Ç–∏–ø: "socks5", "socks4", "http"
    username: "",               // string (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    password: ""                // string (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –ø–∞—Ä–æ–ª—å –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
}
```

–ï—Å–ª–∏ –ø—Ä–æ–∫—Å–∏ –æ—Ç–∫–ª—é—á–µ–Ω: `{ enabled: false }`

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ select

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∏–ø–∞ `select` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–±—Ä–∞—Ç—å –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –æ–ø—Ü–∏–π.

**–§–æ—Ä–º–∞—Ç options:**

1. **–ü—Ä–æ—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫** - –∫–æ–≥–¥–∞ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ label —Å–æ–≤–ø–∞–¥–∞—é—Ç:

```javascript
"options": ["easy", "normal", "hard"]
```

1. **–ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤** - –∫–æ–≥–¥–∞ –Ω—É–∂–Ω—ã —Ä–∞–∑–Ω—ã–µ value –∏ label:

```javascript
"options": [
    { "value": "ru", "label": "–†—É—Å—Å–∫–∏–π" },
    { "value": "en", "label": "English" },
    { "value": "uk", "label": "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" }
]
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç —Å—Ç—Ä–æ–∫–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä: `"normal"`, `"ru"`)

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ø–ª–∞–≥–∏–Ω–µ:**

```javascript
module.exports = (bot, { settings }) => {
    const mode = settings.mode; // "easy" | "normal" | "hard"
    const language = settings.language; // "ru" | "en" | "uk"

    if (mode === 'hard') {
        console.log('–í–∫–ª—é—á—ë–Ω —Å–ª–æ–∂–Ω—ã–π —Ä–µ–∂–∏–º');
    }
};
```

### –£—Å–ª–æ–≤–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ (dependsOn)

–°–∏—Å—Ç–µ–º–∞ `dependsOn` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å/—Å–∫—Ä—ã–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ UI –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏–π –¥—Ä—É–≥–∏—Ö –ø–æ–ª–µ–π. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫ —á–∏—â–µ –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ.

**–ë–∞–∑–æ–≤—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:**

```json
{
  "provider": {
    "type": "select",
    "label": "–ü—Ä–æ–≤–∞–π–¥–µ—Ä",
    "options": ["openrouter", "google"],
    "default": "openrouter"
  },

  "openrouterApiKey": {
    "type": "string",
    "label": "OpenRouter API Key",
    "default": "",
    "secret": true,
    "dependsOn": { "field": "provider", "value": "openrouter" }
  },

  "googleApiKeys": {
    "type": "string[]",
    "label": "Google API Keys",
    "default": [],
    "secret": true,
    "dependsOn": { "field": "provider", "value": "google" }
  }
}
```

**–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ:**
- –ü–æ–ª–µ `openrouterApiKey` –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ** –∫–æ–≥–¥–∞ `provider === "openrouter"`
- –ü–æ–ª–µ `googleApiKeys` –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ** –∫–æ–≥–¥–∞ `provider === "google"`

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:**

```json
{
  "advancedMode": {
    "type": "boolean",
    "label": "–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º",
    "default": false
  },

  "maxConnections": {
    "type": "number",
    "label": "–ú–∞–∫—Å–∏–º—É–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π",
    "default": 10,
    "dependsOn": { "field": "advancedMode", "value": true }
  },

  "minAge": {
    "type": "number",
    "label": "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç",
    "default": 18,
    "dependsOn": { "field": "age", "operator": "gte", "value": 18 }
  },

  "specialFeature": {
    "type": "boolean",
    "label": "–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è",
    "default": false,
    "dependsOn": { "field": "plan", "operator": "ne", "value": "free" }
  }
}
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã:**
- `eq` –∏–ª–∏ –±–µ–∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ - —Ä–∞–≤–Ω–æ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `ne` - –Ω–µ —Ä–∞–≤–Ω–æ
- `gt` - –±–æ–ª—å—à–µ
- `gte` - –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ
- `lt` - –º–µ–Ω—å—à–µ
- `lte` - –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ

**–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è (AND –ª–æ–≥–∏–∫–∞):**

```json
{
  "sslCert": {
    "type": "string",
    "label": "SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç",
    "default": "",
    "dependsOn": [
      { "field": "useSSL", "value": true },
      { "field": "environment", "value": "production" }
    ]
  }
}
```

–ü–æ–ª–µ `sslCert` –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è **—Ç–æ–ª—å–∫–æ** –∫–æ–≥–¥–∞ `useSSL === true` **–ò** `environment === "production"`.

**–ò–Ω–≤–µ—Ä—Å–∏—è —É—Å–ª–æ–≤–∏—è (NOT –ª–æ–≥–∏–∫–∞):**

```json
{
  "customEndpoint": {
    "type": "string",
    "label": "–ö–∞—Å—Ç–æ–º–Ω—ã–π endpoint",
    "default": "",
    "dependsOn": {
      "field": "useDefaultEndpoint",
      "value": false
    }
  }
}
```

**–†–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏–∑ ai-core –ø–ª–∞–≥–∏–Ω–∞:**

```json
{
  "provider": {
    "type": "select",
    "label": "AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä",
    "options": [
      { "value": "openrouter", "label": "OpenRouter" },
      { "value": "google", "label": "Google Gemini" }
    ],
    "default": "openrouter"
  },

  "openrouterApiKey": {
    "type": "string",
    "label": "OpenRouter API Key",
    "secret": true,
    "dependsOn": { "field": "provider", "value": "openrouter" }
  },

  "openrouterModel": {
    "type": "string",
    "label": "–ú–æ–¥–µ–ª—å",
    "default": "google/gemini-2.5-flash",
    "dependsOn": { "field": "provider", "value": "openrouter" }
  },

  "openrouterApiEndpoint": {
    "type": "string",
    "label": "API Endpoint (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)",
    "default": "",
    "dependsOn": { "field": "provider", "value": "openrouter" }
  },

  "enableCostTracking": {
    "type": "boolean",
    "label": "–û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å",
    "default": false,
    "dependsOn": { "field": "provider", "value": "openrouter" }
  },

  "googleApiKeys": {
    "type": "string[]",
    "label": "Google AI API Keys",
    "secret": true,
    "dependsOn": { "field": "provider", "value": "google" }
  },

  "googleModel": {
    "type": "string",
    "label": "Google –º–æ–¥–µ–ª—å",
    "default": "gemini-2.5-flash",
    "dependsOn": { "field": "provider", "value": "google" }
  }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "OpenRouter" ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è: `openrouterApiKey`, `openrouterModel`, `openrouterApiEndpoint`, `enableCostTracking`
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "Google Gemini" ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è: `googleApiKeys`, `googleModel`

**Best Practices:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `dependsOn` –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º/—Ä–µ–∂–∏–º–∞–º
- ‚úÖ –î–µ–ª–∞–π—Ç–µ UI —á–∏—â–µ, –ø–æ–∫–∞–∑—ã–≤–∞—è —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –ø–æ–ª—è
- ‚úÖ –ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ —Å `secret: true` –¥–ª—è –∑–∞—â–∏—Ç—ã —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–Ω—è—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ select –¥–ª—è —É—Å–ª–æ–≤–∏–π
- ‚ùå –ù–µ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (A –∑–∞–≤–∏—Å–∏—Ç –æ—Ç B, B –∑–∞–≤–∏—Å–∏—Ç –æ—Ç A)
- ‚ùå –ù–µ –¥–µ–ª–∞–π—Ç–µ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–º–∞–∫—Å–∏–º—É–º 2-3 —É—Ä–æ–≤–Ω—è)

### –î–æ—Å—Ç—É–ø –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º

```javascript
module.exports = (bot, { settings }) => {
    const token = settings.apiToken;     // –°–µ–∫—Ä–µ—Ç
    const enabled = settings.enabled;    // boolean
    const items = settings.items;        // array

    // –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–∫—Å–∏
    const proxy = settings.proxy;
    if (proxy?.enabled) {
        console.log(`–ü—Ä–æ–∫—Å–∏: ${proxy.type}://${proxy.host}:${proxy.port}`);

        // –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–∫—Å–∏ –∞–≥–µ–Ω—Ç–∞ –¥–ª—è fetch/axios
        const proxyUrl = proxy.username
            ? `${proxy.type}://${proxy.username}:${proxy.password}@${proxy.host}:${proxy.port}`
            : `${proxy.type}://${proxy.host}:${proxy.port}`;
    }
};
```

## 7. PLUGIN REGISTRY - –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï API –î–†–£–ì–ò–• –ü–õ–ê–ì–ò–ù–û–í

### –û–±–∑–æ—Ä

Plugin Registry –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–ª–∞–≥–∏–Ω–∞–º **—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–π API** –∏ **–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –¥—Ä—É–≥–∏—Ö –ø–ª–∞–≥–∏–Ω–æ–≤** –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞.

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:**
- ‚úÖ –ü–ª–∞–≥–∏–Ω —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç API —á–µ—Ä–µ–∑ –ø–æ–ª–µ `exports` –≤ module.exports
- ‚úÖ –î—Ä—É–≥–∏–µ –ø–ª–∞–≥–∏–Ω—ã –ø–æ–ª—É—á–∞—é—Ç –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ `bot.pluginRegistry.get(pluginName)`
- ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ `botpanel.dependencies`
- ‚úÖ –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

### 7.1. –≠–∫—Å–ø–æ—Ä—Ç API –∏–∑ –ø–ª–∞–≥–∏–Ω–∞

–ï—Å–ª–∏ —Ç–≤–æ–π –ø–ª–∞–≥–∏–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (AI, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, —É—Ç–∏–ª–∏—Ç—ã), —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π API:

```javascript
// plugins/ai-core/index.js
async function onLoad(bot, options) {
    const { settings } = options;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞–≥–∏–Ω–∞
    const aiClient = initializeAIClient(settings);

    // ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ ...
}

async function onUnload({ botId, prisma }) {
    // Cleanup
}

// ‚úÖ –≠–ö–°–ü–û–†–¢ API –î–õ–Ø –î–†–£–ì–ò–• –ü–õ–ê–ì–ò–ù–û–í
module.exports = {
    onLoad,
    onUnload,
    exports: {
        /**
         * –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ AI
         * @param {Array<{role: string, content: string}>} messages - –ú–∞—Å—Å–∏–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
         * @param {Object} [options] - –û–ø—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
         * @returns {Promise<{content: string, model: string, usage: Object}>}
         */
        generate: async (messages, options = {}) => {
            return await aiClient.generate({ messages, options });
        },

        /**
         * –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å AI —Å–µ—Ä–≤–∏—Å–∞
         */
        isAvailable: () => {
            return !!aiClient;
        },

        /**
         * –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–µ
         */
        getProviderInfo: () => {
            return {
                type: settings.provider,
                model: settings.model
            };
        }
    }
};
```

**–í–∞–∂–Ω–æ:**
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π —Ç–æ–ª—å–∫–æ PUBLIC API
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π –∫–∞–∂–¥—É—é —Ñ—É–Ω–∫—Ü–∏—é —á–µ—Ä–µ–∑ JSDoc
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –æ—à–∏–±–∫–∏ –≤–Ω—É—Ç—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –ù–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π –∏–∑–º–µ–Ω—è–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é

---

### 7.2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API –¥—Ä—É–≥–æ–≥–æ –ø–ª–∞–≥–∏–Ω–∞

#### –®–∞–≥ 1: –£–∫–∞–∑–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤ package.json

```json
{
  "name": "ai-code-reviewer",
  "version": "1.0.0",
  "botpanel": {
    "dependencies": {
      "ai-core": "^1.0.0"
    }
  }
}
```

–ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç:
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ –ø–ª–∞–≥–∏–Ω `ai-core`
- ‚ö†Ô∏è –°–æ–≤–º–µ—Å—Ç–∏–º–∞ –ª–∏ –≤–µ—Ä—Å–∏—è (–º–∞–∂–æ—Ä–Ω–∞—è –≤–µ—Ä—Å–∏—è)
- ‚ùå –ï—Å–ª–∏ –ø–ª–∞–≥–∏–Ω –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω - –≤—ã–≤–µ–¥–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

#### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API

```javascript
// plugins/ai-code-reviewer/index.js
async function onLoad(bot, options) {
    const log = bot.sendLog;

    // ‚úÖ –ü–æ–ª—É—á–∞–µ–º API –ø–ª–∞–≥–∏–Ω–∞ ai-core
    const aiCoreAPI = bot.pluginRegistry.get('ai-core');

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
    if (!aiCoreAPI) {
        log('[ai-code-reviewer] ‚ùå –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–ª–∞–≥–∏–Ω ai-core!');
        log('[ai-code-reviewer] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–ª–∞–≥–∏–Ω ai-core v1.0.0+');
        return; // –ü—Ä–µ—Ä—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
    }

    if (!aiCoreAPI.isAvailable()) {
        log('[ai-code-reviewer] ‚ö†Ô∏è AI —Å–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
        return;
    }

    log('[ai-code-reviewer] ‚úì AI Core –ø–æ–¥–∫–ª—é—á–µ–Ω');

    // ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º API
    const Command = bot.api.Command;

    class ReviewCommand extends Command {
        constructor() {
            super({
                name: 'review',
                description: '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥ –Ω–∞ —Ä–µ–≤—å—é AI',
                owner: 'plugin:ai-code-reviewer'
            });
        }

        async handler(bot, typeChat, user, args) {
            const { code } = args;

            try {
                bot.api.sendMessage(typeChat, 'üîç –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –∫–æ–¥...', user.username);

                // ‚úÖ –í—ã–∑–æ–≤ API –¥—Ä—É–≥–æ–≥–æ –ø–ª–∞–≥–∏–Ω–∞
                const messages = [
                    {
                        role: 'system',
                        content: '–¢—ã –∫–æ–¥ —Ä–µ–≤—å—é–µ—Ä. –î–∞–π –∫—Ä–∞—Ç–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è).'
                    },
                    {
                        role: 'user',
                        content: `–ü—Ä–æ–≤–µ—Ä—å –∫–æ–¥:\n\n${code}`
                    }
                ];

                const result = await aiCoreAPI.generate(messages);

                bot.api.sendMessage(typeChat, `üìù ${result.content}`, user.username);

            } catch (error) {
                log(`[ai-code-reviewer] –û—à–∏–±–∫–∞: ${error.message}`);
                bot.api.sendMessage(typeChat, '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≤—å—é', user.username);
            }
        }
    }

    await bot.api.registerCommand(new ReviewCommand());
}

module.exports = { onLoad };
```

---

### 7.3. –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –ü–∞—Ç—Ç–µ—Ä–Ω 1: Stateless API (–±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏)

–ü–ª–∞–≥–∏–Ω-–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º:

```javascript
// ai-code-reviewer - –ë–ï–ó –∏—Å—Ç–æ—Ä–∏–∏
const messages = [
    { role: 'system', content: '–¢—ã —Ä–µ–≤—å—é–µ—Ä' },
    { role: 'user', content: code }
];

const result = await aiCoreAPI.generate(messages);
```

#### –ü–∞—Ç—Ç–µ—Ä–Ω 2: Stateful —Å PluginStore (—Å –∏—Å—Ç–æ—Ä–∏–µ–π)

–ü–ª–∞–≥–∏–Ω-–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å —Ö—Ä–∞–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—é –≤ —Å–≤–æ—ë–º store:

```javascript
// ai-translator - –° –∏—Å—Ç–æ—Ä–∏–µ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
async function translateHandler(bot, typeChat, user, args, store) {
    const { text, targetLang } = args;

    // 1. –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –∏–∑ store
    const historyKey = `translator:history:${user.username}`;
    let history = await store.get(historyKey) || [];

    // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ 5 –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏
    if (history.length > 10) {
        history = history.slice(-10);
    }

    // 2. –§–æ—Ä–º–∏—Ä—É–µ–º messages
    const messages = [
        { role: 'system', content: `–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ –Ω–∞ ${targetLang}` },
        ...history,
        { role: 'user', content: text }
    ];

    // 3. –í—ã–∑–æ–≤ AI Core
    const result = await aiCoreAPI.generate(messages);

    // 4. –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ç–æ—Ä–∏—é
    history.push({ role: 'user', content: text });
    history.push({ role: 'assistant', content: result.content });
    await store.set(historyKey, history);

    return result.content;
}
```

#### –ü–∞—Ç—Ç–µ—Ä–Ω 3: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å

–ü–ª–∞–≥–∏–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Å AI –∏ –±–µ–∑ –Ω–µ–≥–æ:

```javascript
async function onLoad(bot, options) {
    const aiCoreAPI = bot.pluginRegistry.get('ai-core');
    const useAI = !!aiCoreAPI;

    if (useAI) {
        log('‚úì AI –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞');
    } else {
        log('‚ö†Ô∏è AI –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞ (–ø–ª–∞–≥–∏–Ω ai-core –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)');
    }

    // –ü–ª–∞–≥–∏–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–±–æ–∏—Ö —Å–ª—É—á–∞—è—Ö
    // ...
}
```

#### –ü–∞—Ç—Ç–µ—Ä–Ω 4: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```javascript
async function onLoad(bot, options) {
    const dependencies = {
        ai: bot.pluginRegistry.get('ai-core'),
        database: bot.pluginRegistry.get('database-manager'),
        cache: bot.pluginRegistry.get('redis-cache')
    };

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
    const missing = Object.entries(dependencies)
        .filter(([name, api]) => !api)
        .map(([name]) => name);

    if (missing.length > 0) {
        log(`‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø–ª–∞–≥–∏–Ω—ã: ${missing.join(', ')}`);
        return;
    }

    // –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ –º–µ—Å—Ç–µ
    log('‚úì –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
}
```

---

### 7.4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –≤–µ—Ä—Å–∏–π

```javascript
async function onLoad(bot, options) {
    const aiCoreAPI = bot.pluginRegistry.get('ai-core');

    if (!aiCoreAPI) {
        log('‚ùå –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–ª–∞–≥–∏–Ω ai-core');
        return;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞
    if (typeof aiCoreAPI.generate !== 'function') {
        log('‚ùå –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è –≤–µ—Ä—Å–∏—è ai-core (–Ω–µ—Ç –º–µ—Ç–æ–¥–∞ generate)');
        return;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
    const providerInfo = aiCoreAPI.getProviderInfo();
    if (providerInfo.type !== 'openrouter') {
        log('‚ö†Ô∏è –ü–ª–∞–≥–∏–Ω –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è OpenRouter –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞');
    }
}
```

---

### 7.5. –≠–∫—Å–ø–æ—Ä—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

–ü–ª–∞–≥–∏–Ω –º–æ–∂–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤:

```javascript
module.exports = {
    onLoad,
    onUnload,
    exports: {
        // –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç—ã —Å AI
        ai: {
            generate: async (messages, options) => { ... },
            isAvailable: () => true
        },

        // –°–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–µ–π
        history: {
            get: async (userId) => { ... },
            clear: async (userId) => { ... },
            export: async (userId) => { ... }
        },

        // –£—Ç–∏–ª–∏—Ç—ã
        utils: {
            cleanEmojis: (text) => { ... },
            formatResponse: (text) => { ... },
            estimateTokens: (text) => { ... }
        }
    }
};

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const aiChatAPI = bot.pluginRegistry.get('ai-chat');
await aiChatAPI.ai.generate(messages);
await aiChatAPI.history.clear('user123');
const clean = aiChatAPI.utils.cleanEmojis('üéâ text');
```

---

### 7.6. Best Practices –¥–ª—è Plugin Registry

‚úÖ **DO:**
- –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π –Ω–∞–ª–∏—á–∏–µ –ø–ª–∞–≥–∏–Ω–∞ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- –£–∫–∞–∑—ã–≤–∞–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ `botpanel.dependencies`
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –æ—à–∏–±–∫–∏ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ API –¥—Ä—É–≥–∏—Ö –ø–ª–∞–≥–∏–Ω–æ–≤
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ JSDoc
- –ò—Å–ø–æ–ª—å–∑—É–π —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π —Ç–æ–ª—å–∫–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ PUBLIC API

‚ùå **DON'T:**
- –ù–µ –ø–æ–ª–∞–≥–∞–π—Å—è –Ω–∞ –ø–æ—Ä—è–¥–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–ª–∞–≥–∏–Ω–æ–≤
- –ù–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π –æ–±—ä–µ–∫—Ç—ã –¥—Ä—É–≥–∏—Ö –ø–ª–∞–≥–∏–Ω–æ–≤
- –ù–µ —Å–æ–∑–¥–∞–≤–∞–π —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (A ‚Üí B ‚Üí A)
- –ù–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π –∏–∑–º–µ–Ω—è–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é
- –ù–µ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (closure) - –ø–µ—Ä–µ–¥–∞–≤–∞–π –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —è–≤–Ω–æ

---

### 7.7. –û—Ç–ª–∞–¥–∫–∞ Plugin Registry

#### –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–ª–∞–≥–∏–Ω–æ–≤

```javascript
// –í –ª—é–±–æ–º –ø–ª–∞–≥–∏–Ω–µ
async function onLoad(bot, options) {
    console.log('–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã —Å API:');

    for (const [name, api] of bot.pluginRegistry.entries()) {
        const methods = Object.keys(api).join(', ');
        console.log(`- ${name}: ${methods}`);
    }
}
```


---

## 8. –•–†–ê–ù–ï–ù–ò–ï –î–ê–ù–ù–´–• (PluginStore)

KV —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```javascript
module.exports = (bot, { store }) => {
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
    await store.set('player:John:kills', { kills: 10, deaths: 5 });

    // –ü–æ–ª—É—á–µ–Ω–∏–µ
    const data = await store.get('player:John:kills');

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è
    const exists = await store.has('player:John:kills');

    // –£–¥–∞–ª–µ–Ω–∏–µ
    await store.delete('player:John:kills');

    // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–ª–∞–≥–∏–Ω–∞
    const allData = await store.getAll();  // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç Map

    // –ü–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è —Å—á–µ—Ç—á–∏–∫–æ–≤
    const key = `player:${username}:stats`;
    let stats = await store.get(key) || { kills: 0, deaths: 0 };
    stats.kills++;
    await store.set(key, stats);
};
```

## 8. –†–ê–ë–û–¢–ê –° –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø–ú–ò

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```javascript
const user = await bot.api.getUser('PlayerName');

// –°–≤–æ–π—Å—Ç–≤–∞ user
user.username       // –ù–∏–∫
user.isOwner        // –í–ª–∞–¥–µ–ª–µ—Ü –±–æ—Ç–∞
user.groups         // –ú–∞—Å—Å–∏–≤ –≥—Ä—É–ø–ø
user.permissions    // –ú–∞—Å—Å–∏–≤ –ø—Ä–∞–≤

// –ú–µ—Ç–æ–¥—ã
user.hasPermission('plugin.admin')  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∞
```

### –î–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

```javascript
// –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫
const isBlacklisted = await bot.api.performUserAction(username, 'isBlacklisted');
await bot.api.performUserAction(username, 'setBlacklisted', { value: true });

// –ì—Ä—É–ø–ø—ã
await bot.api.performUserAction(username, 'addToGroup', { groupName: 'VIP' });
await bot.api.performUserAction(username, 'removeFromGroup', { groupName: 'VIP' });
```

## 9. –û–¢–ü–†–ê–í–ö–ê –°–û–û–ë–©–ï–ù–ò–ô

```javascript
// –û–±—â–∏–π —á–∞—Ç
bot.api.sendMessage('chat', '–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!');

// –õ–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
bot.api.sendMessage('private', '–ü—Ä–∏–≤–µ—Ç!', 'PlayerName');

// –õ–æ–∫–∞–ª—å–Ω—ã–π —á–∞—Ç
bot.api.sendMessage('local', '–õ–æ–∫–∞–ª—å–Ω–æ');

// –ö–ª–∞–Ω–æ–≤—ã–π —á–∞—Ç
bot.api.sendMessage('clan', '–ö–ª–∞–Ω—É');

// –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É
bot.api.sendMessage('command', '/spawn');

// WebSocket –æ—Ç–≤–µ—Ç
bot.api.sendMessage('websocket', { data: 'response' });
```

### –¶–≤–µ—Ç–æ–≤—ã–µ –∫–æ–¥—ã

```
&0 - –ß–µ—Ä–Ω—ã–π       &8 - –¢–µ–º–Ω–æ-—Å–µ—Ä—ã–π
&1 - –°–∏–Ω–∏–π        &9 - –ì–æ–ª—É–±–æ–π
&2 - –ó–µ–ª–µ–Ω—ã–π      &a - –°–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π
&3 - –ë–∏—Ä—é–∑–æ–≤—ã–π    &b - –°–≤–µ—Ç–ª–æ-–±–∏—Ä—é–∑–æ–≤—ã–π
&4 - –ö—Ä–∞—Å–Ω—ã–π      &c - –°–≤–µ—Ç–ª–æ-–∫—Ä–∞—Å–Ω—ã–π
&5 - –§–∏–æ–ª–µ—Ç–æ–≤—ã–π   &d - –†–æ–∑–æ–≤—ã–π
&6 - –ó–æ–ª–æ—Ç–æ–π      &e - –ñ–µ–ª—Ç—ã–π
&7 - –°–µ—Ä—ã–π        &f - –ë–µ–ª—ã–π

&l - –ñ–∏—Ä–Ω—ã–π       &n - –ü–æ–¥—á–µ—Ä–∫–Ω—É—Ç—ã–π
&o - –ö—É—Ä—Å–∏–≤       &m - –ó–∞—á–µ—Ä–∫–Ω—É—Ç—ã–π
&r - –°–±—Ä–æ—Å
```

## 10. –ü–†–ê–í–ê –ò –ì–†–£–ü–ü–´

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∞–≤

```javascript
await bot.api.registerPermissions([
    {
        name: 'myplugin.use',
        owner: PLUGIN_OWNER_ID,
        description: '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–ª–∞–≥–∏–Ω–∞'
    },
    {
        name: 'myplugin.admin',
        owner: PLUGIN_OWNER_ID,
        description: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ'
    }
]);
```

### –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã

```javascript
await bot.api.registerGroup({
    name: 'Moderators',
    owner: PLUGIN_OWNER_ID,
    permissions: ['myplugin.use', 'myplugin.moderate']
});
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –≥—Ä—É–ø–ø—É

```javascript
await bot.api.addPermissionsToGroup('Admin', ['myplugin.admin']);
```

## 11. –í–ò–ó–£–ê–õ–¨–ù–´–ï –ì–†–ê–§–´

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞ –∏–∑ –ø–ª–∞–≥–∏–Ω–∞

```javascript
await bot.api.registerEventGraph({
    name: 'my-event-graph',
    owner: PLUGIN_OWNER_ID,
    isEnabled: true,
    graphJson: JSON.stringify({
        nodes: [...],
        edges: [...]
    }),
    triggers: ['chat', 'playerJoined'],
    variables: []
});
```

### –§–∞–π–ª—ã –≥—Ä–∞—Ñ–æ–≤

–†–∞–∑–º–µ—Å—Ç–∏ JSON —Ñ–∞–π–ª—ã –≥—Ä–∞—Ñ–æ–≤ –≤ –ø–∞–ø–∫–µ `graph/`:
```
my-plugin/
‚îî‚îÄ‚îÄ graph/
    ‚îî‚îÄ‚îÄ my-graph.json
```

–û–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø–ª–∞–≥–∏–Ω–∞.

## 12. –õ–û–ì–ò–†–û–í–ê–ù–ò–ï

```javascript
// –õ–æ–≥ –≤ –∫–æ–Ω—Å–æ–ª—å –±–æ—Ç–∞ (–≤–∏–¥–µ–Ω –≤ UI)
bot.sendLog('[MyPlugin] –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è');

// console –ø–ª–∞–≥–∏–Ω–∞ (–ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è)
console.log('[MyPlugin] Debug info');
console.error('[MyPlugin] Error');
```

## 13. MINEFLAYER API

### –î–æ—Å—Ç—É–ø –∫ –±–æ—Ç—É

```javascript
bot.username        // –ù–∏–∫ –±–æ—Ç–∞
bot.health          // –ó–¥–æ—Ä–æ–≤—å–µ
bot.food            // –ï–¥–∞
bot.entity          // –°—É—â–Ω–æ—Å—Ç—å –±–æ—Ç–∞
bot.entities        // –í—Å–µ —Å—É—â–Ω–æ—Å—Ç–∏
bot.players         // –ò–≥—Ä–æ–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
bot.inventory       // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
bot.world           // –ú–∏—Ä
```

### –ü–æ–ª–µ–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã mineflayer

```javascript
// –ü–æ–∑–∏—Ü–∏—è
bot.entity.position  // Vec3

// –î–≤–∏–∂–µ–Ω–∏–µ
bot.setControlState('forward', true);
bot.setControlState('jump', true);
bot.clearControlStates();

// –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
bot.inventory.slots
bot.inventory.items()

// –ò–≥—Ä–æ–∫–∏
bot.players['PlayerName']
Object.keys(bot.players)
```

## 14. –ü–†–ò–ú–ï–†–´

### –ü—Ä–æ—Å—Ç–æ–π –ø–ª–∞–≥–∏–Ω —Å –∫–æ–º–∞–Ω–¥–æ–π

```javascript
// constants.js
const PLUGIN_OWNER_ID = 'plugin:hello-world';
const PERMISSIONS = { USE: 'hello.use' };
module.exports = { PLUGIN_OWNER_ID, PERMISSIONS };

// commands/hello.js
const { PLUGIN_OWNER_ID, PERMISSIONS } = require('../constants');

module.exports = (bot) => {
    class HelloCommand extends bot.api.Command {
        constructor() {
            super({
                name: 'hello',
                aliases: ['hi', '–ø—Ä–∏–≤–µ—Ç'],
                description: '–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ',
                permissions: PERMISSIONS.USE,
                owner: PLUGIN_OWNER_ID,
                allowedChatTypes: ['chat', 'private']
            });
        }

        async handler(bot, typeChat, user) {
            bot.api.sendMessage(typeChat, `&a–ü—Ä–∏–≤–µ—Ç, &e${user.username}&a!`, user.username);
        }
    }
    return HelloCommand;
};

// index.js
const { PLUGIN_OWNER_ID, PERMISSIONS } = require('./constants');
const createHelloCommand = require('./commands/hello');

async function onLoad(bot) {
    await bot.api.registerPermissions([
        { name: PERMISSIONS.USE, owner: PLUGIN_OWNER_ID, description: '–ö–æ–º–∞–Ω–¥–∞ hello' }
    ]);

    const HelloCommand = createHelloCommand(bot);
    await bot.api.registerCommand(new HelloCommand());

    bot.sendLog('[HelloWorld] –ó–∞–≥—Ä—É–∂–µ–Ω');
}

async function onUnload({ botId, prisma }) {
    await prisma.command.deleteMany({ where: { botId, owner: PLUGIN_OWNER_ID } });
    await prisma.permission.deleteMany({ where: { botId, owner: PLUGIN_OWNER_ID } });
}

module.exports = { onLoad, onUnload };
```

### –ü–ª–∞–≥–∏–Ω —Å —Å–æ–±—ã—Ç–∏—è–º–∏ –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º

```javascript
// events/onPlayerJoin.js
module.exports = (bot, settings, store) => {
    bot.on('playerJoined', async (player) => {
        const key = `visits:${player.username}`;
        let visits = await store.get(key) || 0;
        visits++;
        await store.set(key, visits);

        if (settings.greetEnabled) {
            const msg = settings.greetMessage
                .replace('{player}', player.username)
                .replace('{visits}', visits);
            bot.api.sendMessage('chat', msg);
        }
    });
};

// index.js
const setupPlayerJoin = require('./events/onPlayerJoin');

async function onLoad(bot, { settings, store }) {
    setupPlayerJoin(bot, settings, store);
    bot.sendLog('[Greeter] –ó–∞–≥—Ä—É–∂–µ–Ω');
}

module.exports = { onLoad };
```

### –ü–ª–∞–≥–∏–Ω —Å –≤–Ω–µ—à–Ω–∏–º API

```javascript
// lib/api.js
class ExternalAPI {
    constructor(token) {
        this.token = token;
        this.baseUrl = 'https://api.example.com';
    }

    async request(endpoint, data) {
        const response = await fetch(`${this.baseUrl}${endpoint}`, {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${this.token}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        });
        return response.json();
    }

    async sendEvent(event, payload) {
        return this.request('/events', { event, payload });
    }
}

module.exports = ExternalAPI;

// index.js
const ExternalAPI = require('./lib/api');

async function onLoad(bot, { settings }) {
    if (!settings.apiToken) {
        bot.sendLog('[MyPlugin] –û–®–ò–ë–ö–ê: API —Ç–æ–∫–µ–Ω –Ω–µ —É–∫–∞–∑–∞–Ω');
        return;
    }

    const api = new ExternalAPI(settings.apiToken);

    bot.on('playerJoined', async (player) => {
        await api.sendEvent('player_join', { username: player.username });
    });
}

module.exports = { onLoad };
```

## 15. –û–¢–õ–ê–î–ö–ê

```javascript
// –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
bot.sendLog(`[MyPlugin] [DEBUG] –î–∞–Ω–Ω—ã–µ: ${JSON.stringify(data)}`);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
bot.sendLog(`[MyPlugin] –ù–∞—Å—Ç—Ä–æ–π–∫–∏: ${JSON.stringify(settings)}`);

// –û—Ç–ª–æ–≤ –æ—à–∏–±–æ–∫
try {
    await riskyOperation();
} catch (error) {
    bot.sendLog(`[MyPlugin] [ERROR] ${error.stack}`);
}
```

## 16. BEST PRACTICES

### –û–±—â–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π PLUGIN_OWNER_ID** –¥–ª—è –∫–æ–º–∞–Ω–¥, –ø—Ä–∞–≤ –∏ –≥—Ä—É–ø–ø
2. **–û—á–∏—â–∞–π —Ä–µ—Å—É—Ä—Å—ã –≤ onUnload** - —É–¥–∞–ª—è–π –∫–æ–º–∞–Ω–¥—ã –∏ –ø—Ä–∞–≤–∞ –∏–∑ –ë–î
3. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –æ—à–∏–±–∫–∏** - –Ω–µ –¥–∞–≤–∞–π –ø–ª–∞–≥–∏–Ω—É –∫—Ä–∞—à–∏—Ç—å –±–æ—Ç–∞
4. **–ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã** - –≤—ã–Ω–æ—Å–∏ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∑–Ω–∞—á–µ–Ω–∏—è
5. **–ü—Ä–æ–≤–µ—Ä—è–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** - –≤–∞–ª–∏–¥–∏—Ä—É–π –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
6. **–õ–æ–≥–∏—Ä—É–π –≤–∞–∂–Ω–æ–µ** - –Ω–æ –Ω–µ —Å–ø–∞–º—å
7. **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–π –∫–æ–¥** - —Ä–∞–∑–¥–µ–ª—è–π –ø–æ –ø–∞–ø–∫–∞–º –∏ —Ñ–∞–π–ª–∞–º
8. **–ù–µ –¥—É–±–ª–∏—Ä—É–π –ª–æ–≥–∏–∫—É** - –≤—ã–Ω–æ—Å–∏ –≤ lib/
9. **–ü–∏—à–∏ –ø–æ–Ω—è—Ç–Ω—ã–µ –∏–º–µ–Ω–∞** - —Ñ–∞–π–ª–æ–≤, —Ñ—É–Ω–∫—Ü–∏–π, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
10. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π** - README –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω

### Plugin Registry –ø—Ä–∞–∫—Ç–∏–∫–∏

11. **–ü—Ä–æ–≤–µ—Ä—è–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** - –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π `bot.pluginRegistry.get()` –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
12. **–£–∫–∞–∑—ã–≤–∞–π dependencies** - –≤ `botpanel.dependencies` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
13. **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π —Ç–æ–ª—å–∫–æ PUBLIC API** - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π
14. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π —ç–∫—Å–ø–æ—Ä—Ç—ã** - –∏—Å–ø–æ–ª—å–∑—É–π JSDoc –¥–ª—è –≤—Å–µ—Ö —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
15. **–ò–∑–±–µ–≥–∞–π —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - –ø–ª–∞–≥–∏–Ω A –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç B, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç A
16. **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä—É–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ** - –∏—Å–ø–æ–ª—å–∑—É–π semver (major.minor.patch)
17. **–ù–µ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–π –∫–æ–Ω—Ç–µ–∫—Å—Ç** - —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∞—Ç—å –≤—Å–µ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
18. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –æ—à–∏–±–∫–∏ –≤ exports** - –Ω–µ –¥–æ–ø—É—Å–∫–∞–π —á—Ç–æ–±—ã –æ—à–∏–±–∫–∏ –≤—ã–ª–µ—Ç–∞–ª–∏ –Ω–∞—Ä—É–∂—É
